<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeaconMarket - Seed Database</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f9fafb;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0ea5e9;
        }
        button {
            background: #0ea5e9;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 10px 5px 10px 0;
        }
        button:hover {
            background: #0284c7;
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }
        .error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }
        .info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #3b82f6;
        }
        pre {
            background: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèñÔ∏è BeaconMarket - Database Seeder</h1>
        <p>This tool will populate your database with 10 sample listings to test the marketplace.</p>
        
        <p><strong>Before you start:</strong></p>
        <ol>
            <li>Make sure you've set up Supabase and configured <code>js/config.js</code></li>
            <li>Verify the database table has been created</li>
            <li>Click the button below to seed sample data</li>
        </ol>

        <button onclick="seedDatabase()">üå± Seed Database (10 listings)</button>
        <button onclick="clearDatabase()" style="background: #ef4444;">üóëÔ∏è Clear All Listings</button>

        <div id="status"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Initialize Supabase
        const SUPABASE_URL = 'https://fuddzrlnbrseofguuikp.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ1ZGR6cmxuYnJzZW9mZ3V1aWtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2MDE5NjMsImV4cCI6MjA4NzE3Nzk2M30.pAWnJbzoS-mWOt3LiCVSxb1exm8eT0_rAfT9kSt2XJo';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
    </script>
    <script>
        const sampleListings = [
            {
                category: "holiday-homes",
                title: "Luxury 3-Bedroom Beach House",
                description: "Stunning sea-facing home with pool, 3 bedrooms, 2 bathrooms. Sleeps 6. Fully equipped kitchen, DSTV, WiFi. Walk to beach in 2 minutes. Perfect for families.",
                price: 3500,
                price_unit: "per night",
                owner_name: "Sarah Thompson",
                whatsapp: "0721234567",
                email: "sarah@example.com",
                verified_resident: true
            },
            {
                category: "equipment",
                title: "Mountain Bikes (2 available)",
                description: "Two well-maintained mountain bikes. Perfect for exploring Plett trails. Helmets included. Available daily or weekly rental.",
                price: 200,
                price_unit: "per day",
                owner_name: "Mike van der Merwe",
                whatsapp: "0837654321",
                verified_resident: true
            },
            {
                category: "equipment",
                title: "2x Stand-Up Paddleboards (SUPs)",
                description: "Inflatable SUPs with paddles, pumps, and safety leashes. Great for calm days on the lagoon. Beginner-friendly.",
                price: 150,
                price_unit: "per day",
                owner_name: "Lisa Jacobs",
                whatsapp: "0829876543",
                verified_resident: true
            },
            {
                category: "services",
                title: "Professional Cleaner",
                description: "Experienced cleaner available for holiday homes and regular cleaning. References available. 8 years in Beacon Isle. Very reliable.",
                price: 250,
                price_unit: "per service",
                owner_name: "Nomsa Dlamini",
                whatsapp: "0734561234",
                verified_resident: true
            },
            {
                category: "events",
                title: "Artist Easel for Rent",
                description: "Professional wooden easel, perfect for functions or painting sessions. Adjustable height. Good condition.",
                price: 50,
                price_unit: "per day",
                owner_name: "Val Peterson",
                whatsapp: "0828868631",
                verified_resident: true
            },
            {
                category: "equipment",
                title: "Weber Braai on Wheels",
                description: "Large Weber kettle braai with wheels. Perfect for beach braais or big gatherings. Includes grid and tools.",
                price: 100,
                price_unit: "per day",
                owner_name: "Johan Pretorius",
                whatsapp: "0847123456",
                verified_resident: true
            },
            {
                category: "holiday-homes",
                title: "Cozy 2-Bed Garden Cottage",
                description: "Private cottage with garden view. 2 bedrooms, 1 bathroom. Sleeps 4. Quiet location, secure parking. WiFi and DSTV included.",
                price: 1800,
                price_unit: "per night",
                owner_name: "Peter and Jane Williams",
                whatsapp: "0829991234",
                email: "williams@example.com",
                verified_resident: true
            },
            {
                category: "services",
                title: "Private Chef - Seafood Specialist",
                description: "Local chef available for dinner parties and special occasions. Specialize in fresh seafood and South African cuisine. Menus tailored to your needs.",
                price: 800,
                price_unit: "per service",
                owner_name: "Chef Marco",
                whatsapp: "0731239876",
                email: "marco@example.com",
                verified_resident: true
            },
            {
                category: "parking",
                title: "Secure Garage Space Available",
                description: "Single lock-up garage available for monthly rental. Perfect for boat, caravan, or vehicle storage. 24/7 estate security.",
                price: 500,
                price_unit: "per month",
                owner_name: "Robert Lee",
                whatsapp: "0823334455",
                verified_resident: true
            },
            {
                category: "equipment",
                title: "Kids' Beach Toys & Boogie Boards",
                description: "Collection of beach toys, 2 boogie boards, sand toys, buckets. Perfect for keeping the kids entertained. Clean and well-maintained.",
                price: 50,
                price_unit: "per day",
                owner_name: "Emma Davis",
                whatsapp: "0827778899",
                verified_resident: true
            }
        ];

        async function seedDatabase() {
            const statusDiv = document.getElementById('status');
            statusDiv.className = 'info';
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = '‚è≥ Seeding database...';

            try {
                const { data, error } = await supabase
                    .from('listings')
                    .insert(sampleListings);

                if (error) throw error;

                statusDiv.className = 'success';
                statusDiv.innerHTML = `
                    ‚úÖ <strong>Success!</strong><br>
                    10 sample listings have been added to your database.<br><br>
                    <a href="index.html" style="color: #065f46; font-weight: 600;">View Marketplace ‚Üí</a>
                `;
            } catch (error) {
                statusDiv.className = 'error';
                statusDiv.innerHTML = `
                    ‚ùå <strong>Error:</strong><br>
                    ${error.message}<br><br>
                    <small>Make sure you've configured js/config.js correctly and created the database table.</small>
                `;
                console.error('Seed error:', error);
            }
        }

        async function clearDatabase() {
            if (!confirm('Are you sure you want to delete ALL listings? This cannot be undone.')) {
                return;
            }

            const statusDiv = document.getElementById('status');
            statusDiv.className = 'info';
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = '‚è≥ Clearing database...';

            try {
                const { error } = await supabase
                    .from('listings')
                    .delete()
                    .neq('id', '00000000-0000-0000-0000-000000000000'); // Delete all

                if (error) throw error;

                statusDiv.className = 'success';
                statusDiv.innerHTML = '‚úÖ All listings have been deleted.';
            } catch (error) {
                statusDiv.className = 'error';
                statusDiv.innerHTML = `‚ùå Error: ${error.message}`;
                console.error('Clear error:', error);
            }
        }
    </script>
</body>
</html>
